<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.mysql.mapperTeam">




    <select id="login" parameterType="ModelUser" resultType="ModelUser">
        SELECT *
        FROM tb_cafe_user
        WHERE email = #{email} and passwd =
        #{passwd}
    </select>

    <select id="selectUserOne" parameterType="int" resultType="ModelUser">
        SELECT *
        FROM TB_cafe_user
        WHERE userno = #{userno}
    </select>

    <select id="getTeamList" parameterType="ModelUser">

        SELECT *
        FROM
        tb_cafe_user
        WHERE email like concat('%', #{email}, '%');
    </select>

    <insert id="insertTeam" parameterType="ModelUser">

        INSERT INTO
        tb_cafe_user ( email , passwd , userphone , useraddr , sex ,
        emailselect , usernickname )
        VALUES ( #{email}, #{passwd},
        #{userphone}, #{useraddr}, #{sex}, #{emailselect} ,
        #{usernickname} )
        
    </insert>



    <insert id="insertReview" parameterType="ModelCafeReview">
        INSERT INTO
        tb_cafe_review ( content , grade , regdate )
        VALUES ( #{content},
        #{grade}, now() )
    </insert>


    <!-- <insert id = "insertTeam" parameterType = "ModelUser"> INSERT INTO 
        tb_cafe_user ( email , passwd , userphone , useraddr , sex , emailselect 
        , usernickname ) VALUES ( #{email}, #{passwd}, #{userphone}, #{useraddr}, 
        #{sex}, #{emailselect} , #{usernickname} ) </insert> -->

    <select id="getCafeList" parameterType="java.util.Map"
        resultType="ModelCafeinfo">
        SELECT *
        FROM tb_cafe_cafeinfo
        where cafebigtype =
        #{searchValue.cafebigtype}
        <trim prefix="ORDER BY">
            <if test="orderKind == 'cafename' "> cafename ASC </if>
            <if test="orderKind == 'like_count' "> like_count DESC </if>
            <if test="orderKind == 'avg_grade' "> avg_grade DESC </if>
            <if test="orderKind == 'review_count' "> review_count DESC </if>
        </trim>
    </select>

    <update id="updateUserinfo" parameterType="hashmap">
        UPDATE tb_cafe_user
        SET
        passwd = #{updateValue.passwd}
        , userphone =
        #{updateValue.userphone}
        , useraddr = #{updateValue.useraddr}
        ,
        sex = #{updateValue.sex}
        , usernickname =
        #{updateValue.usernickname}
        , emailselect =
        #{updateValue.emailselect}

        WHERE email = #{searcheValue.email}

    </update>

    <update id="updatePasswd" parameterType="hashmap">
        UPDATE
        TB_cafe_user
        SET passwd = #{updateValue.passwd}
        WHERE email =
        #{searchValue.email}
    </update>

    <delete id="deleteUser" parameterType="ModelUser">
        DELETE FROM TB_cafe_user
        WHERE 1 = 1
        <if test="email != null and email != ''">
            and email = #{email}
        </if>
    </delete>

</mapper>

